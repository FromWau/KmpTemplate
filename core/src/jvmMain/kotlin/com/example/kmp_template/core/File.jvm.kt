package com.example.kmp_template.core

import kotlinx.io.files.Path

@Suppress("EXPECT_ACTUAL_CLASSIFIERS_ARE_IN_BETA_WARNING")
actual class SystemAppDirectories {
    private val os = System.getProperty("os.name").lowercase()
    private val userHome = System.getProperty("user.home")
    private val appName = "kmp_template"

    actual fun dataDir(): Path {
        return when {
            os.contains("win") -> Path(System.getenv("APPDATA"), appName)
            os.contains("mac") -> Path(userHome, "Library/Application Support/$appName")
            else -> {
                System.getenv("XDG_DATA_HOME")
                    ?.let { Path(it, appName) }
                    ?: Path("$userHome/.local/share/$appName")
            }
        }
    }

    actual fun configDir(): Path {
        return when {
            os.contains("win") -> Path(System.getenv("APPDATA"), appName)
            os.contains("mac") -> Path(userHome, "Library/Application Support/$appName")
            else -> {
                System.getenv("XDG_CONFIG_HOME")
                    ?.let { Path(it, appName) }
                    ?: Path("$userHome/.config/$appName")
            }
        }
    }

    actual fun homeDir(): Path = Path(userHome)

    actual fun mediaDir(): Path = Path(dataDir(), "media")
}
